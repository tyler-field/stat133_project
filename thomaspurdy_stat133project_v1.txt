###A bunch of libraries, just in case:
library(plyr)
library(DataComputing)
library(printr)
library(tidyr)
library(ggthemes)
library(ggplot2)
library(rvest)
library(lubridate)
###Reading in the data:
FlightData <- read.csv("C:\\Users\\Thomas\\Desktop\\Stat 133 Flight Delay Data.csv")
###Removing Bad DEP_DELAY entries:
FlightData1 <- FlightData %>% subset(DEP_DELAY!="")
###Making table for delays by traffic:
Average_Delay_Airport <- ddply(FlightData1,"ORIGIN",summarise,averagedelay=mean(DEP_DELAY))
OriginAirports <- data.frame(table(FlightData1$ORIGIN))
OriginAirports <- OriginAirports %>% mutate(ORIGIN=Var1,DEP_FREQUENCY=Freq)
Delays_by_Traffic <- left_join(OriginAirports,Average_Delay_Airport)


###FIRST PLOT:  Delays by Traffic
ggplot(Delays_by_Traffic,aes(x=DEP_FREQUENCY,y=averagedelay))+geom_point()+xlab("Number of Flights Departing Airport")+ylab("Average Delay (Minutes)")+theme_igray()+ggtitle("Departure Delays by Airport Traffic")

###Arrival Delays by Distance:
ggplot(data=FlightData[sample(nrow(FlightData),10000),],aes(x=DISTANCE,y=ARR_DELAY))+geom_point()+xlab("Distance of Flight (Miles)")+ylab("Arrival Delay (Minutes)")+theme_igray()+ggtitle("Arrival Delays by Flight Distance")