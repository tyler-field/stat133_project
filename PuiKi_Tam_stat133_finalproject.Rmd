---
title: "STAT133 Final Project"
author: "Pui Ki Tam 3032325323"
date: "4/28/2017"
output: html_document
---

<!-- Don't edit in between this line and the one below -->
```{r include=FALSE}
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)
library(dplyr)
library(ggplot2)
library(maps)
```
*Source file* 
```{r, results='asis', echo=FALSE}
includeSourceDocuments()
```
<!-- Don't edit the material above this line -->
```{r}
#	Name	Description
#1	Year	1987-2008
#2	Month	1-12
#3	DayofMonth	1-31
#4	DayOfWeek	1 (Monday) - 7 (Sunday)
#5	DepTime	actual departure time (local, hhmm)
#6	CRSDepTime	scheduled departure time (local, hhmm)
#7	ArrTime	actual arrival time (local, hhmm)
#8	CRSArrTime	scheduled arrival time (local, hhmm)
#9	UniqueCarrier	unique carrier code
#10	FlightNum	flight number
#11	TailNum	plane tail number
#12	ActualElapsedTime	in minutes
#13	CRSElapsedTime	in minutes
#14	AirTime	in minutes
#15	ArrDelay	arrival delay, in minutes
#16	DepDelay	departure delay, in minutes
#17	Origin	origin IATA airport code
#18	Dest	destination IATA airport code
#19	Distance	in miles
#20	TaxiIn	taxi in time, in minutes
#21	TaxiOut	taxi out time in minutes
#22	Cancelled	was the flight cancelled?
#23	CancellationCode	reason for cancellation (A = carrier, B = weather, C = NAS, D = security)
#24	Diverted	1 = yes, 0 = no
#25	CarrierDelay	in minutes
#26	WeatherDelay	in minutes
#27	NASDelay	in minutes
#28	SecurityDelay	in minutes
#29	LateAircraftDelay	in minutes
```

```{r}
setwd("/Users/pktam/Desktop")
getwd()
df <- read.csv("AirplaneData.csv")
names(df)

table1 <- select(df, FL_DATE, ORIGIN, DEP_DELAY, CARRIER_DELAY, WEATHER_DELAY, NAS_DELAY, SECURITY_DELAY, LATE_AIRCRAFT_DELAY)

table2 <- table1 %>% filter(DEP_DELAY>0)

table3 <- table2 %>% mutate(Total_Delay= CARRIER_DELAY + WEATHER_DELAY + NAS_DELAY + SECURITY_DELAY + LATE_AIRCRAFT_DELAY)

table4 <- table3 %>% filter(DEP_DELAY>= Total_Delay)

```

```{r}
table4

countCarrierD <- length(which(table4$CARRIER_DELAY > 0))

countWeatherD <- length(which(table4$WEATHER_DELAY > 0))

countNasD <- length(which(table4$NAS_DELAY > 0))

countSecurityD <- length(which(table4$SECURITY_DELAY > 0))

countAircraftD <- length(which(table4$LATE_AIRCRAFT_DELAY > 0))

pie_number <- c(countCarrierD, countWeatherD, countNasD, countSecurityD, countAircraftD)
labels <- c("Carrier Delay", "Weather Delay", "NAS Delay", "Security Delay", "Late Aircraft Delay")

piepercent <- round(100*pie_number/length(table4$DEP_DELAY), 1)

png(file= "DelayPie.jpg")

pie(pie_number, labels= piepercent, main = "Delay Causes in Jan2017", col = rainbow(length(pie_number)))
legend("topright", labels, cex = 0.78, fill = rainbow(length(pie_number)))

dev.off()
```
